// Employee Mini-Test: Questions, Profiles, and Scoring Logic

export interface EmployeeTestQuestion {
    id: number;
    text: string;
    options: {
        variant: 'A' | 'B' | 'C';
        text: string;
        profile: EmployeeProfileType;
    }[];
}

export type EmployeeProfileType = 'resultnik' | 'processnik' | 'statusnik';

export interface EmployeeProfile {
    type: EmployeeProfileType;
    title: string;
    description: string;
    recommendations: string[];
}

// 7 вопросов мини-теста по сотруднику
export const EMPLOYEE_TEST_QUESTIONS: EmployeeTestQuestion[] = [
    {
        id: 1,
        text: 'Когда вы ставите этому сотруднику конкретный план или KPI, чаще всего вы видите, что он…',
        options: [
            {
                variant: 'A',
                text: 'Уточняет детали, просит чётко прописать шаги и порядок, чтобы понять, как именно работать по плану',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Сразу фокусируется на цифрах и результате, предлагает, как можно сделать быстрее/эффективнее',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Интересуется, кто ещё об этом знает, как это повлияет на его роль и заметность для руководства',
                profile: 'statusnik',
            },
        ],
    },
    {
        id: 2,
        text: 'Вы меняете правила работы (скрипты, отчётность, формат взаимодействия). Сотрудник чаще всего…',
        options: [
            {
                variant: 'A',
                text: 'Просит подробно объяснить новый порядок, фиксирует изменения и аккуратно перестраивает свою работу',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Смотрит, как это повлияет на результат и бонусы, предлагает способ внедрить изменения так, чтобы не потерять в цифрах',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Сначала пытается понять, кто инициатор и как это отразится на его позиции и влиянии в команде',
                profile: 'statusnik',
            },
        ],
    },
    {
        id: 3,
        text: 'Когда сотрудник рассказывает про свои успехи, он чаще всего говорит о том, что…',
        options: [
            {
                variant: 'A',
                text: 'Все процессы под контролем, сроки соблюдены, отчёты сданы, ошибок в работе минимум',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Сделал план или перевыполнил его, есть конкретный прирост в показателях и результатах',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Его заметили, к нему стали прислушиваться, он участвует в важных решениях и совещаниях',
                profile: 'statusnik',
            },
        ],
    },
    {
        id: 4,
        text: 'Когда появляются срочные задачи, клиенты "горят", сроки сжимаются, сотрудник чаще всего…',
        options: [
            {
                variant: 'A',
                text: 'Структурирует задачи по приоритетам, просит чёткий порядок и планирует, что и в какой последовательности делать',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Берёт на себя самые сложные или ключевые задачи, включается как "спринтер", чтобы вытащить результат',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Очень активно включается в коммуникацию, участвует во всех обсуждениях, показывая свою вовлечённость и нужность',
                profile: 'statusnik',
            },
        ],
    },
    {
        id: 5,
        text: 'Если вы усиливаете контроль (добавляете отчёты, проверки, разбор показателей), сотрудник…',
        options: [
            {
                variant: 'A',
                text: 'В целом спокойно относится, уточняет формат и сроки, подстраивает график и продолжает работать по новым правилам',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Может раздражаться, если контроль мешает скорости и результату, но готов принять его, если видит связь с целью',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Может воспринимать это как личное недоверие, старается показать свою лояльность и значимость, доказывает, что заслуживает доверия',
                profile: 'statusnik',
            },
        ],
    },
    {
        id: 6,
        text: 'На планёрках и рабочих встречах сотрудник чаще всего…',
        options: [
            {
                variant: 'A',
                text: 'Говорит по делу, задаёт уточняющие вопросы, фиксирует решения и следит за порядком обсуждения',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Предлагает конкретные решения, спорит по сути, фокусируется на том, что реально двигает результат',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Стремится быть заметным, много выступает, показывает свою осведомлённость и связи, активно обозначает своё мнение',
                profile: 'statusnik',
            },
        ],
    },
    {
        id: 7,
        text: 'Если нужно задержаться, выйти в выходной или поехать к сложному клиенту, сотрудник чаще…',
        options: [
            {
                variant: 'A',
                text: 'Сначала смотрит, как это вписывается в его текущий график и обязанности; если это часть принятых правил, согласится и встроит в свой план',
                profile: 'processnik',
            },
            {
                variant: 'B',
                text: 'Быстро соглашается, если понимает, что это критично для результата, клиента или выполнения плана',
                profile: 'resultnik',
            },
            {
                variant: 'C',
                text: 'Оценивает, насколько это будет заметно для руководства и как повлияет на его репутацию и статус, и действует исходя из этого',
                profile: 'statusnik',
            },
        ],
    },
];

// Описания профилей сотрудников
export const EMPLOYEE_PROFILES: Record<EmployeeProfileType, EmployeeProfile> = {
    resultnik: {
        type: 'resultnik',
        title: 'Результатник',
        description:
            'Фокусируется на целях и цифрах. Готов менять подход, чтобы сделать результат, важны понятные цели и влияние на итог.',
        recommendations: [
            'Ставьте чёткие измеримые цели и показывайте связь его задач с выручкой и ключевыми показателями.',
            'Давайте пространство для инициативы и права выбора методов, избегайте избыточного микроменеджмента.',
            'Регулярно разбирайте с ним результаты, динамику и точки роста.',
            'Фиксируйте успехи и усиливайте их премиями и более сложными задачами.',
            'Обсуждайте рамки качества и правил, чтобы он не «пробивал план любой ценой».',
        ],
    },
    processnik: {
        type: 'processnik',
        title: 'Процессник',
        description:
            'Ориентирован на порядок, стабильность и чёткие правила. Сильная сторона — надёжность и системность.',
        recommendations: [
            'Обеспечьте понятные регламенты, инструкции и предсказуемый контур задач.',
            'Не меняйте правила слишком часто; если нужно, объясняйте причины и давайте время на адаптацию.',
            'Контроль выстраивайте через плановые точки и чек-листы, а не через хаотичные проверки.',
            'В качестве признания подчёркивайте его аккуратность, стабильность и качество работы.',
            'Используйте его как носителя стандарта для ввода новых сотрудников и стабилизации процессов.',
        ],
    },
    statusnik: {
        type: 'statusnik',
        title: 'Статусник',
        description:
            'Для него важны признание, влияние и заметность. Сильная сторона — умение работать с людьми и позиционировать себя.',
        recommendations: [
            'Чётко обозначьте зону его ответственности и влияния, чтобы он понимал, за что отвечает.',
            'Давайте задачи, где он может быть заметен: презентации, проекты, сложные переговоры.',
            'Признание делайте адресно и публично — в присутствии значимых для него людей (руководство, ключевые коллеги).',
            'Привязывайте статус к реальным результатам, чтобы не возникал разрыв между картинкой и цифрами.',
            'Следите за рисками интриг и игр во влияние, обеспечивайте прозрачность правил и критериев оценки.',
        ],
    },
};

// Интерфейс для ответа на вопрос
export interface EmployeeTestAnswer {
    questionId: number;
    option: 'A' | 'B' | 'C';
}

// Результат теста
export interface EmployeeTestResult {
    profileType: EmployeeProfileType;
    scores: {
        resultnik: number;
        processnik: number;
        statusnik: number;
    };
}

// Функция расчёта профиля по ответам
export function calculateEmployeeProfile(answers: EmployeeTestAnswer[]): EmployeeTestResult {
    const scores = {
        resultnik: 0,
        processnik: 0,
        statusnik: 0,
    };

    // Подсчитываем баллы
    answers.forEach((answer) => {
        const question = EMPLOYEE_TEST_QUESTIONS.find((q) => q.id === answer.questionId);
        if (question) {
            const option = question.options.find((opt) => opt.variant === answer.option);
            if (option) {
                scores[option.profile] += 1;
            }
        }
    });

    // Находим профиль с максимальным счётом
    let profileType: EmployeeProfileType = 'resultnik';
    let maxScore = scores.resultnik;

    if (scores.processnik > maxScore) {
        profileType = 'processnik';
        maxScore = scores.processnik;
    }
    if (scores.statusnik > maxScore) {
        profileType = 'statusnik';
        maxScore = scores.statusnik;
    }

    return {
        profileType,
        scores,
    };
}
